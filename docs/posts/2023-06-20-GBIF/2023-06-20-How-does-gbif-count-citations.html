<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brett Johnson">
<meta name="dcterms.date" content="2023-06-20">
<meta name="description" content="How to use the DataCite REST API to understand how GBIF counts citations">

<title>Brett Johnson - How Does the Global Biodiversity Information System Count Citations from the International Year of the Salmon?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VBNXHNYDDE"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VBNXHNYDDE', { 'anonymize_ip': true});
</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/d3-4.5.0/d3.min.js"></script>
<script src="../../site_libs/forceNetwork-binding-0.4/forceNetwork.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Brett Johnson</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Br-Johnson" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/_BrettJohnson" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">How Does the Global Biodiversity Information System Count Citations from the International Year of the Salmon?</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          How to use the DataCite REST API to understand how GBIF counts citations
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Biodiversity</div>
                <div class="quarto-category">GBIF</div>
                <div class="quarto-category">Datacite</div>
                <div class="quarto-category">International Year of the Salmon</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Brett Johnson </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 20, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>If you publish your data to the <a href="https://www.gbif.org/">Global Biodiversity Information Facility (GBIF)</a>, you may notice that your dataset is being cited by papers that seemingly have nothing to do with the context of your original project that produced the dataset. For example, check out the <a href="https://www.gbif.org/resource/search?contentType=literature&amp;gbifDatasetKey=d80c46be-b600-44d5-9758-ef5159d40002">citations of this zooplankton dataset</a>.</p>
<p>I had a colleague involved with the <a href="https://yearofthesalmon.org">International Year of the Salmon</a> (IYS) ask why this zooplankton dataset from the IYS expeditions was referenced in <a href="https://doi.org/10.1016/j.biocon.2023.110118">a paper that seemed to be about terrestrial species</a> <span class="citation" data-cites="garcía-roselló2023">(<a href="#ref-garcía-roselló2023" role="doc-biblioref"><strong>garcía-roselló2023?</strong></a>)</span>. It’s not immediately obvious how the IYS zooplankton dataset was used in this paper, but if you dig in a little deeper it becomes clear, and frankly amazing, how GBIF integrates data and counts citations.</p>
<section id="how-was-the-iys-zoop-data-used" class="level3">
<h3 class="anchored" data-anchor-id="how-was-the-iys-zoop-data-used">How was the IYS Zoop Data Used?</h3>
<p>If you look in the references section of the Garcia-Rosello et al.&nbsp;(2023) paper you will see two links to GBIF Occurrence Downloads. If you click on the DOI for the second GBIF Occurrence Download dataset <span class="citation" data-cites="gbif.orguser2022">(<a href="#ref-gbif.orguser2022" role="doc-biblioref">GBIF.Org User 2022</a>)</span>, you will reach a landing page for an Occurrence Download on GBIF from a specific query made by a user. You can even see the specific query filters that were used to generate the dataset.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.gbif.org/occurrence/download/0008235-220831081235567"><img src="images/Screenshot 2023-06-28 at 8.00.15 AM.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">The query filters generated by a GBIF user to return an integrated dataset</figcaption>
</figure>
</div>
<p>A total of 18,426 datasets that meet the query filter. The filter included: has CC BY-NC 4.0 licence, Basis of record must be either Human observation, Observation or Preserved Specimen, Has coordinate is true, … Scientific name includes Animalia). As it turns out, this is a very broad filter basically asking for all the animal occurrences on GBIF datasets that have the right license and metadata and the IYS dataset about zooplankton met all those criteria. If you wanted to see all the datasets included in the new dataset you can download a list of the involved datasets using the “Download as TSV” link from the <a href="https://doi.org/10.15468/dl.udrufp">GBIF Occurrence Dataset landing page</a> for this big dataset and search for International Year of the Salmon to see which datasets are included.<br>
<br>
So the dataset that resulted from this specific query includes data from 18,426 other GBIF datasets which meet the query filter parameters. This new dataset receives a Digital Object Identifier and each of those underlying datasets also has a digital object identifier. GBIF is able to count citations because each of those 18,426 DOIs is referenced in the new dataset’s DOI metadata as a ‘relatedIdentifier’. So, each time the overarching dataset is cited, the citation count for each of the 18,426 datasets increases by one as well. Pretty cool, huh!?<br>
</p>
<p>I can be surprising how the International Year of the Salmon data are re-used way outside the context of their collection, which is a major advantage of using the GBIF and publishing data using international standards. This also demonstrates the power of standardized data: new datasets can be integrated, downloaded, and identified with a DOI on the fly!</p>
<p>If you’re interested in finding all 18,427 Digital Object Identfiers and their titles or other metadata here’s how you could do that using the <a href="https://support.datacite.org/docs/api">DataCite API</a> and the <a href="https://docs.ropensci.org/rdatacite/index.html">rdatacite R package</a> and searching for the DOI of the overarching dataset and extracting the <code>relatedIdentifiers</code> field.</p>
</section>
<section id="international-year-of-the-salmon-datasets" class="level3">
<h3 class="anchored" data-anchor-id="international-year-of-the-salmon-datasets">International Year of the Salmon Datasets</h3>
<p>For a more interesting example, let’s look at how all the International Year of the Salmon datasets have been cited thus far. To do that we’ll take a similar approach but instead of searching for a specific DOI we’ll query for International Year of the Salmon in all the datacite DOIs, and extract each datasets <code>relatedIdentifiers</code>. We’ll then search for those <code>relatedIdentifiers</code> to retrieve their titles. Finally, I’ll join all that data together and present a network map of how each dataset connected by citations.</p>
<div class="cell" data-fig.margin="true" data-hash="2023-06-20-How-does-gbif-count-citations_cache/html/unnamed-chunk-1_2a08871d1ae85f987250f819584cf7a6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rdatacite)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># download the DOI metadata for the new overarching dataset</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>gbif_doi <span class="ot">&lt;-</span> <span class="fu">dc_dois</span>(<span class="at">ids =</span> <span class="st">"10.15468/dl.cqpa99"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>datasets_used <span class="ot">&lt;-</span> gbif_doi[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"relatedIdentifiers"</span>]][[<span class="dv">1</span>]][<span class="st">"relatedIdentifier"</span>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the data from 'International Year of the Salmon' titles</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>iys_dois <span class="ot">&lt;-</span> <span class="fu">dc_dois</span>(<span class="at">query =</span> <span class="st">"titles.title:International Year of the Salmon"</span>, <span class="at">limit =</span> <span class="dv">1000</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble with the title, citation count, and DOI for each record, then filter by citation count greater than 0</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>iys_citations <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="fu">lapply</span>(iys_dois<span class="sc">$</span>data<span class="sc">$</span>attributes<span class="sc">$</span>titles, <span class="st">"[["</span>, <span class="st">"title"</span>),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">citations =</span> iys_dois[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"citationCount"</span>]],</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">doi =</span> iys_dois[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"doi"</span>]]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">filter</span>(citations <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduce the title to the substring from the 4th to the 80th character</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>iys_citations<span class="sc">$</span>title <span class="ot">&lt;-</span> <span class="fu">substr</span>(iys_citations<span class="sc">$</span>title, <span class="dv">4</span>, <span class="dv">80</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store citation details of each DOI</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>cites_iys_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch citation details of each DOI and store it in the list</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> iys_citations<span class="sc">$</span>doi) {</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">dc_events</span>(<span class="at">obj_id =</span> <span class="fu">paste0</span>(<span class="st">"https://doi.org/"</span>, i))</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  cites_iys_list[[i]] <span class="ot">&lt;-</span> x</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize lists to store objId and subjId</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>obj_ids <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>subj_ids <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over the list to retrieve objId and subjId</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cites_iys_list)) {</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> cites_iys_list[[i]]<span class="sc">$</span>data<span class="sc">$</span>attributes</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  obj_ids[[i]] <span class="ot">&lt;-</span> data<span class="sc">$</span>objId</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  subj_ids[[i]] <span class="ot">&lt;-</span> data<span class="sc">$</span>subjId</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the lists and remove the prefix 'https://doi.org/'</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>obj_ids <span class="ot">&lt;-</span> <span class="fu">substring</span>(<span class="fu">unlist</span>(obj_ids), <span class="dv">17</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>subj_ids <span class="ot">&lt;-</span> <span class="fu">substring</span>(<span class="fu">unlist</span>(subj_ids), <span class="dv">17</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Get titles for objId and subjId</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>obj_titles <span class="ot">&lt;-</span> rdatacite<span class="sc">::</span><span class="fu">dc_dois</span>(<span class="at">ids =</span> obj_ids, <span class="at">limit =</span> <span class="dv">1000</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>subj_titles <span class="ot">&lt;-</span> rdatacite<span class="sc">::</span><span class="fu">dc_dois</span>(<span class="at">ids =</span> subj_ids, <span class="at">limit =</span> <span class="dv">1000</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble of position, obj_doi, and its corresponding title</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>obj_dois <span class="ot">&lt;-</span> obj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"doi"</span>]]</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>title_list <span class="ot">&lt;-</span> obj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"titles"</span>]]</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>title_vector <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">map</span>(title_list, <span class="cf">function</span>(x) x[[<span class="st">'title'</span>]][<span class="dv">1</span>]))</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>seq <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(obj_dois))</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">position =</span> seq, obj_dois, title_vector)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble of position, subj_doi, and its corresponding title</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>subj_dois <span class="ot">&lt;-</span> subj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"doi"</span>]]</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>subjtitle_list <span class="ot">&lt;-</span> subj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"titles"</span>]]</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>subjtitle_vector <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">map</span>(subjtitle_list, <span class="cf">function</span>(x) x[[<span class="st">'title'</span>]][<span class="dv">1</span>]))</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>seq2 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(subj_dois))</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>subjects <span class="ot">&lt;-</span> <span class="fu">tibble</span>(seq2, subj_dois, subjtitle_vector) <span class="sc">|&gt;</span> </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(subjtitle_vector <span class="sc">!=</span> <span class="st">"Zooplankton Bongo Net Data from the 2019 and 2020 Gulf of Alaska International Year of the Salmon Expeditions"</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Get related identifiers and filter by obj_dois, join with subjects, and filter by relationType</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>subj_related_ids <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(subj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"relatedIdentifiers"</span>]], <span class="at">.id =</span> <span class="st">"position"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(objects, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'relatedIdentifier'</span> <span class="ot">=</span> <span class="st">'obj_dois'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(subjects, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'position'</span> <span class="ot">=</span> <span class="st">'seq2'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(relationType <span class="sc">!=</span> <span class="st">"IsPreviousVersionOf"</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Join objects and subj_related_ids by 'obj_dois' = 'relatedIdentifier'</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>relationships <span class="ot">&lt;-</span> <span class="fu">full_join</span>(objects, subj_related_ids, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'obj_dois'</span> <span class="ot">=</span> <span class="st">'relatedIdentifier'</span>))</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for network plot</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>objects<span class="sc">$</span>type.label <span class="ot">&lt;-</span> <span class="st">"IYS Dataset"</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>subjects<span class="sc">$</span>type.label <span class="ot">&lt;-</span> <span class="st">"Referencing Dataset"</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">c</span>(objects<span class="sc">$</span>obj_dois,subjects<span class="sc">$</span>subj_dois)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(objects<span class="sc">$</span>title_vector, subjects<span class="sc">$</span>subjtitle_vector)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>type.label <span class="ot">&lt;-</span> <span class="fu">c</span>(objects<span class="sc">$</span>type.label, subjects<span class="sc">$</span>type.label)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Create edges for network plot</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">from =</span> relationships<span class="sc">$</span>obj_dois, <span class="at">to =</span> relationships<span class="sc">$</span>subj_dois)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>links.d3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="fu">as.numeric</span>(<span class="fu">factor</span>(edges<span class="sc">$</span>from))<span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>                       <span class="at">to=</span><span class="fu">as.numeric</span>(<span class="fu">factor</span>(edges<span class="sc">$</span>to))<span class="sc">-</span><span class="dv">1</span> ) </span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> links.d3 <span class="sc">|&gt;</span> </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(from) <span class="sc">|&gt;</span> </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">weight =</span> <span class="fu">n</span>())</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(ids, names, type.label) <span class="sc">|&gt;</span> </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    names <span class="sc">==</span> <span class="st">"Occurrence Download"</span> <span class="sc">~</span> <span class="fu">paste0</span>(names, <span class="st">" "</span>, ids),</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> names</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>length <span class="ot">&lt;-</span> <span class="fu">nrow</span>(nodes)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>missing_length <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(length) <span class="sc">-</span> <span class="fu">nrow</span>(size)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>missing_size <span class="ot">&lt;-</span> <span class="fu">rep.int</span>(<span class="dv">0</span>, missing_length)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">c</span>(size<span class="sc">$</span>weight, missing_size)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>size <span class="ot">&lt;-</span> size</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>nodes.d3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">idn=</span><span class="fu">factor</span>(nodes<span class="sc">$</span>names, <span class="at">levels=</span>nodes<span class="sc">$</span>names), nodes) </span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and render the network plot</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">forceNetwork</span>(<span class="at">Links =</span> links.d3, <span class="at">Nodes =</span> nodes.d3, <span class="at">Source=</span><span class="st">"from"</span>, <span class="at">Target=</span><span class="st">"to"</span>,</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>               <span class="at">NodeID =</span> <span class="st">"idn"</span>, <span class="at">Group =</span> <span class="st">"type.label"</span>,<span class="at">linkWidth =</span> <span class="dv">1</span>,</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>               <span class="at">linkColour =</span> <span class="st">"#afafaf"</span>, <span class="at">fontSize=</span><span class="dv">12</span>, <span class="at">zoom=</span>T, <span class="at">legend=</span>T, </span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>               <span class="at">Nodesize=</span><span class="st">"size"</span>, <span class="at">opacity =</span> <span class="fl">0.8</span>, <span class="at">charge=</span><span class="sc">-</span><span class="dv">300</span>,</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="dv">600</span>, <span class="at">height =</span> <span class="dv">400</span>)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-9e5ae7de6ffc939c247a" style="width:100%;height:433px;" class="forceNetwork html-widget "></div>
<script type="application/json" data-for="htmlwidget-9e5ae7de6ffc939c247a">{"x":{"links":{"source":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5],"target":[17,18,14,5,27,4,10,2,1,3,12,15,26,20,8,9,24,19,6,7,16,22,0,23,13,25,17,14,5,27,3,15,20,21,24,17,18,14,5,27,3,15,26,20,21,11,24,6,16,0,17,5,27,3,15,20,17,14,5,27,4,10,2,1,3,12,15,26,20,8,24,16,17,18,14,5,27,3,15,26,20,21,24,6,7,16,22,0,17,14,5,27,4,10,2,1,3,12,15,26,20,8,24,19,16,17,5,27,3,15,26,20,21,24,17,5,27,3,15,20,21,17,14,5,27,3,15,20,21,24],"colour":["#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf","#afafaf"]},"nodes":{"name":["Zooplankton Bongo Net Data from the 2019 and 2020 Gulf of Alaska International Year of the Salmon Expeditions","Trawl Data from the R/V TINRO during the 2022 International Year of the Salmon Pan-Pacific Winter High Seas Expedition","Trawl Catch and Species Abundance data from the 2020 Gulf of Alaska International Year of the Salmon Expedition","Bongo Zooplankton Data from the R/V TINRO, NOAA Bell M. Shimada and F/V Northwest Explorer during the 2022 International Year of the Salmon Pan-Pacific Winter High Seas Expedition","Juday Net Zooplankton Data from the 2019 Gulf of Alaska International Year of the Salmon Expedition","Trawl Catch and Species Abundance from the 2019 Gulf of Alaska International Year of the Salmon Expedition","Juday Net Zooplankton Data from the 2020 Gulf of Alaska International Year of the Salmon Expedition","Trawl Data from the CCGS Sir John Franklin during the 2022 International Year of the Salmon Pan-Pacific Winter High Seas Expedition","Trawl Data from the FV Northwest Explorer during the 2022 International Year of the Salmon Pan-Pacific Winter High Seas Expedition","Trawl Data from the NOAA Bell M. Shimada during the 2022 International Year of the Salmon Pan-Pacific Winter High Seas Expedition","Occurrence Download 10.15468/dl.gx742r","Occurrence Download 10.15468/dl.hz87ut","Occurrence Download 10.15468/dl.cqpa99","Occurrence Download 10.15468/dl.6vdkbn","Occurrence Download 10.15468/dl.zycegr","Occurrence Download 10.15468/dl.5bs8n8","Occurrence Download 10.15468/dl.862h55","Occurrence Download 10.15468/dl.3yf6de","Occurrence Download 10.15468/dl.23aja3","Occurrence Download 10.15468/dl.459uag","Occurrence Download 10.15468/dl.ajb76z","Occurrence Download 10.15468/dl.f8s2hg","Occurrence Download 10.15468/dl.vaz2q7","Occurrence Download 10.15468/dl.pk3trq","Occurrence Download 10.15468/dl.7gzvbw","Occurrence Download 10.15468/dl.rm8rn8","Occurrence Download 10.15468/dl.a5mbxn","Occurrence Download 10.15468/dl.7m3x6e","Occurrence Download 10.15468/dl.ucfhd2","Occurrence Download 10.15468/dl.mpsknf","Occurrence Download 10.15468/dl.6vtqy8","Occurrence Download 10.15468/dl.72zk7d","Occurrence Download 10.15468/dl.fdqx94","Occurrence Download 10.15468/dl.t4gc8j","More than half of data deficient species predicted to be threatened by extinction","Occurrence Download 10.15468/dl.tsup7a","Occurrence Download 10.15468/dl.c3mkt8","Occurrence Download 10.15468/dl.v4qqas"],"group":["IYS Dataset","IYS Dataset","IYS Dataset","IYS Dataset","IYS Dataset","IYS Dataset","IYS Dataset","IYS Dataset","IYS Dataset","IYS Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset","Referencing Dataset"],"nodesize":[15,26,16,17,9,9,7,9,6,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"options":{"NodeID":"idn","Group":"type.label","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":"serif","clickTextSize":30,"linkDistance":50,"linkWidth":"1","charge":-300,"opacity":0.8,"zoom":true,"legend":true,"arrows":false,"nodesize":true,"radiusCalculation":" Math.sqrt(d.nodesize)+6","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>In summary, the DataCite REST API offers a lot of great details about datasets published with a DOI. Using this service you can understand how your data are being used in a programmatic way that would be easy to create a dashboard with.</p>
<p>One limitation to Datacite’s REST API, however, is that it only indexes DOIs minted by Datacite and not by other services such as CrossRef which mints DOIs mainly for journal articles.</p>
<p>Thankfully, DataCite also offers a <a href="https://support.datacite.org/docs/datacite-graphql-api-guide">GraphQL API</a> which indexes not only DataCite and Crossref, but also <a href="https://orcid.org/">ORCID</a>, and <a href="https://ror.org/">ROR</a>! So, stay tuned for a future blog post demonstrating the use of this amazing service.</p>


<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-gbif.orguser2022" class="csl-entry" role="listitem">
GBIF.Org User. 2022. <span>“Occurrence Download.”</span> The Global Biodiversity Information Facility. <a href="https://doi.org/10.15468/DL.CQPA99">https://doi.org/10.15468/DL.CQPA99</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb2" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> How Does the Global Biodiversity Information System Count Citations from the International Year of the Salmon?</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Brett Johnson</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2023-06-20</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> 'images/IYS_data_citations.png'</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Biodiversity, GBIF, Datacite, International Year of the Salmon]</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> 'How to use the DataCite REST API to understand how GBIF counts citations'</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="an">archives:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - 2023/06</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> false</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>If you publish your data to the <span class="co">[</span><span class="ot">Global Biodiversity Information Facility (GBIF)</span><span class="co">](https://www.gbif.org/)</span>, you may notice that your dataset is being cited by papers that seemingly have nothing to do with the context of your original project that produced the dataset. For example, check out the <span class="co">[</span><span class="ot">citations of this zooplankton dataset</span><span class="co">](https://www.gbif.org/resource/search?contentType=literature&amp;gbifDatasetKey=d80c46be-b600-44d5-9758-ef5159d40002)</span>.</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>I had a colleague involved with the <span class="co">[</span><span class="ot">International Year of the Salmon</span><span class="co">](https://yearofthesalmon.org)</span> (IYS) ask why this zooplankton dataset from the IYS expeditions was referenced in <span class="co">[</span><span class="ot">a paper that seemed to be about terrestrial species</span><span class="co">](https://doi.org/10.1016/j.biocon.2023.110118)</span> <span class="co">[</span><span class="ot">@garcía-roselló2023</span><span class="co">]</span>. It's not immediately obvious how the IYS zooplankton dataset was used in this paper, but if you dig in a little deeper it becomes clear, and frankly amazing, how GBIF integrates data and counts citations.</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">### How was the IYS Zoop Data Used?</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>If you look in the references section of the Garcia-Rosello et al. (2023) paper you will see two links to GBIF Occurrence Downloads. If you click on the DOI for the second GBIF Occurrence Download dataset <span class="co">[</span><span class="ot">@gbif.orguser2022</span><span class="co">]</span>, you will reach a landing page for an Occurrence Download on GBIF from a specific query made by a user. You can even see the specific query filters that were used to generate the dataset.</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="al">![The query filters generated by a GBIF user to return an integrated dataset](images/Screenshot%202023-06-28%20at%208.00.15%20AM.png)</span><span class="co">](https://www.gbif.org/occurrence/download/0008235-220831081235567)</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>A total of 18,426 datasets that meet the query filter. The filter included: has CC BY-NC 4.0 licence, Basis of record must be either Human observation, Observation or Preserved Specimen, Has coordinate is true, ... Scientific name includes Animalia). As it turns out, this is a very broad filter basically asking for all the animal occurrences on GBIF datasets that have the right license and metadata and the IYS dataset about zooplankton met all those criteria. If you wanted to see all the datasets included in the new dataset you can download a list of the involved datasets using the "Download as TSV" link from the <span class="co">[</span><span class="ot">GBIF Occurrence Dataset landing page</span><span class="co">](https://doi.org/10.15468/dl.udrufp)</span> for this big dataset and search for International Year of the Salmon to see which datasets are included.\</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>So the dataset that resulted from this specific query includes data from 18,426 other GBIF datasets which meet the query filter parameters. This new dataset receives a Digital Object Identifier and each of those underlying datasets also has a digital object identifier. GBIF is able to count citations because each of those 18,426 DOIs is referenced in the new dataset's DOI metadata as a 'relatedIdentifier'. So, each time the overarching dataset is cited, the citation count for each of the 18,426 datasets increases by one as well. Pretty cool, huh!?\</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>It can be surprising how the International Year of the Salmon data are re-used way outside the context of their collection, which is a major advantage of using the GBIF and publishing data using international standards. This also demonstrates the power of standardized data: new datasets can be integrated, downloaded, and identified with a DOI on the fly!</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>If you're interested in finding all 18,427 Digital Object Identifiers and their titles or other metadata, you too could do that using the <span class="co">[</span><span class="ot">DataCite API</span><span class="co">](https://support.datacite.org/docs/api)</span> and the <span class="co">[</span><span class="ot">rdatacite R package</span><span class="co">](https://docs.ropensci.org/rdatacite/index.html)</span> and searching for the DOI of the overarching dataset and extracting the <span class="in">`relatedIdentifiers`</span> field.</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">### International Year of the Salmon Datasets</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>For a more interesting example, let's look at how all the International Year of the Salmon datasets have been cited thus far. To do that we'll take a similar approach but instead of searching for a specific DOI we'll query for International Year of the Salmon in all the datacite DOIs, and extract each datasets <span class="in">`relatedIdentifiers`</span>. We'll then search for those <span class="in">`relatedIdentifiers`</span> to retrieve their titles. Finally, I'll join all that data together and present a network map of how each dataset is connected by citations.</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning = FALSE, message=FALSE, fig.margin=TRUE, cache=TRUE}</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rdatacite)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="co"># download the DOI metadata for the new overarching dataset</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>gbif_doi <span class="ot">&lt;-</span> <span class="fu">dc_dois</span>(<span class="at">ids =</span> <span class="st">"10.15468/dl.cqpa99"</span>)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>datasets_used <span class="ot">&lt;-</span> gbif_doi[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"relatedIdentifiers"</span>]][[<span class="dv">1</span>]][<span class="st">"relatedIdentifier"</span>]</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the data from 'International Year of the Salmon' titles</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>iys_dois <span class="ot">&lt;-</span> <span class="fu">dc_dois</span>(<span class="at">query =</span> <span class="st">"titles.title:International Year of the Salmon"</span>, <span class="at">limit =</span> <span class="dv">1000</span>)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble with the title, citation count, and DOI for each record, then filter by citation count greater than 0</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>iys_citations <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="fu">lapply</span>(iys_dois<span class="sc">$</span>data<span class="sc">$</span>attributes<span class="sc">$</span>titles, <span class="st">"[["</span>, <span class="st">"title"</span>),</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">citations =</span> iys_dois[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"citationCount"</span>]],</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">doi =</span> iys_dois[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"doi"</span>]]</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">filter</span>(citations <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduce the title to the substring from the 4th to the 80th character</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>iys_citations<span class="sc">$</span>title <span class="ot">&lt;-</span> <span class="fu">substr</span>(iys_citations<span class="sc">$</span>title, <span class="dv">4</span>, <span class="dv">80</span>)</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store citation details of each DOI</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>cites_iys_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch citation details of each DOI and store it in the list</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> iys_citations<span class="sc">$</span>doi) {</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">dc_events</span>(<span class="at">obj_id =</span> <span class="fu">paste0</span>(<span class="st">"https://doi.org/"</span>, i))</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>  cites_iys_list[[i]] <span class="ot">&lt;-</span> x</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize lists to store objId and subjId</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>obj_ids <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>subj_ids <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over the list to retrieve objId and subjId</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cites_iys_list)) {</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> cites_iys_list[[i]]<span class="sc">$</span>data<span class="sc">$</span>attributes</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  obj_ids[[i]] <span class="ot">&lt;-</span> data<span class="sc">$</span>objId</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>  subj_ids[[i]] <span class="ot">&lt;-</span> data<span class="sc">$</span>subjId</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the lists and remove the prefix 'https://doi.org/'</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>obj_ids <span class="ot">&lt;-</span> <span class="fu">substring</span>(<span class="fu">unlist</span>(obj_ids), <span class="dv">17</span>)</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>subj_ids <span class="ot">&lt;-</span> <span class="fu">substring</span>(<span class="fu">unlist</span>(subj_ids), <span class="dv">17</span>)</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Get titles for objId and subjId</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>obj_titles <span class="ot">&lt;-</span> rdatacite<span class="sc">::</span><span class="fu">dc_dois</span>(<span class="at">ids =</span> obj_ids, <span class="at">limit =</span> <span class="dv">1000</span>)</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>subj_titles <span class="ot">&lt;-</span> rdatacite<span class="sc">::</span><span class="fu">dc_dois</span>(<span class="at">ids =</span> subj_ids, <span class="at">limit =</span> <span class="dv">1000</span>)</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble of position, obj_doi, and its corresponding title</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>obj_dois <span class="ot">&lt;-</span> obj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"doi"</span>]]</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>title_list <span class="ot">&lt;-</span> obj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"titles"</span>]]</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>title_vector <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">map</span>(title_list, <span class="cf">function</span>(x) x[[<span class="st">'title'</span>]][<span class="dv">1</span>]))</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>seq <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(obj_dois))</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">position =</span> seq, obj_dois, title_vector)</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble of position, subj_doi, and its corresponding title</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>subj_dois <span class="ot">&lt;-</span> subj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"doi"</span>]]</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>subjtitle_list <span class="ot">&lt;-</span> subj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"titles"</span>]]</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>subjtitle_vector <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">map</span>(subjtitle_list, <span class="cf">function</span>(x) x[[<span class="st">'title'</span>]][<span class="dv">1</span>]))</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>seq2 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(subj_dois))</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>subjects <span class="ot">&lt;-</span> <span class="fu">tibble</span>(seq2, subj_dois, subjtitle_vector) <span class="sc">|&gt;</span> </span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(subjtitle_vector <span class="sc">!=</span> <span class="st">"Zooplankton Bongo Net Data from the 2019 and 2020 Gulf of Alaska International Year of the Salmon Expeditions"</span>)</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Get related identifiers and filter by obj_dois, join with subjects, and filter by relationType</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>subj_related_ids <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(subj_titles[[<span class="st">"data"</span>]][[<span class="st">"attributes"</span>]][[<span class="st">"relatedIdentifiers"</span>]], <span class="at">.id =</span> <span class="st">"position"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(objects, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'relatedIdentifier'</span> <span class="ot">=</span> <span class="st">'obj_dois'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(subjects, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'position'</span> <span class="ot">=</span> <span class="st">'seq2'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(relationType <span class="sc">!=</span> <span class="st">"IsPreviousVersionOf"</span>)</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Join objects and subj_related_ids by 'obj_dois' = 'relatedIdentifier'</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>relationships <span class="ot">&lt;-</span> <span class="fu">full_join</span>(objects, subj_related_ids, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'obj_dois'</span> <span class="ot">=</span> <span class="st">'relatedIdentifier'</span>))</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for network plot</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>objects<span class="sc">$</span>type.label <span class="ot">&lt;-</span> <span class="st">"IYS Dataset"</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>subjects<span class="sc">$</span>type.label <span class="ot">&lt;-</span> <span class="st">"Referencing Dataset"</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">c</span>(objects<span class="sc">$</span>obj_dois,subjects<span class="sc">$</span>subj_dois)</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(objects<span class="sc">$</span>title_vector, subjects<span class="sc">$</span>subjtitle_vector)</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>type.label <span class="ot">&lt;-</span> <span class="fu">c</span>(objects<span class="sc">$</span>type.label, subjects<span class="sc">$</span>type.label)</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Create edges for network plot</span></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">from =</span> relationships<span class="sc">$</span>obj_dois, <span class="at">to =</span> relationships<span class="sc">$</span>subj_dois)</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>links.d3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="fu">as.numeric</span>(<span class="fu">factor</span>(edges<span class="sc">$</span>from))<span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>                       <span class="at">to=</span><span class="fu">as.numeric</span>(<span class="fu">factor</span>(edges<span class="sc">$</span>to))<span class="sc">-</span><span class="dv">1</span> ) </span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> links.d3 <span class="sc">|&gt;</span> </span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(from) <span class="sc">|&gt;</span> </span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">weight =</span> <span class="fu">n</span>())</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(ids, names, type.label) <span class="sc">|&gt;</span> </span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>    names <span class="sc">==</span> <span class="st">"Occurrence Download"</span> <span class="sc">~</span> <span class="fu">paste0</span>(names, <span class="st">" "</span>, ids),</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> names</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>length <span class="ot">&lt;-</span> <span class="fu">nrow</span>(nodes)</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>missing_length <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(length) <span class="sc">-</span> <span class="fu">nrow</span>(size)</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>missing_size <span class="ot">&lt;-</span> <span class="fu">rep.int</span>(<span class="dv">0</span>, missing_length)</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">c</span>(size<span class="sc">$</span>weight, missing_size)</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>size <span class="ot">&lt;-</span> size</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>nodes.d3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">idn=</span><span class="fu">factor</span>(nodes<span class="sc">$</span>names, <span class="at">levels=</span>nodes<span class="sc">$</span>names), nodes) </span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and render the network plot</span></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">forceNetwork</span>(<span class="at">Links =</span> links.d3, <span class="at">Nodes =</span> nodes.d3, <span class="at">Source=</span><span class="st">"from"</span>, <span class="at">Target=</span><span class="st">"to"</span>,</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>               <span class="at">NodeID =</span> <span class="st">"idn"</span>, <span class="at">Group =</span> <span class="st">"type.label"</span>,<span class="at">linkWidth =</span> <span class="dv">1</span>,</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>               <span class="at">linkColour =</span> <span class="st">"#afafaf"</span>, <span class="at">fontSize=</span><span class="dv">12</span>, <span class="at">zoom=</span>T, <span class="at">legend=</span>T, </span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>               <span class="at">Nodesize=</span><span class="st">"size"</span>, <span class="at">opacity =</span> <span class="fl">0.8</span>, <span class="at">charge=</span><span class="sc">-</span><span class="dv">300</span>,</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="dv">600</span>, <span class="at">height =</span> <span class="dv">400</span>)</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>In summary, the DataCite REST API offers a lot of great details about datasets published with a DOI. Using this service you can understand how your data are being used in a programmatic way that would be easy to create a dashboard with.</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>One limitation to Datacite's REST API, however, is that it only indexes DOIs minted by Datacite and not by other services such as CrossRef which mints DOIs mainly for journal articles.</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>Thankfully, DataCite also offers a <span class="co">[</span><span class="ot">GraphQL API</span><span class="co">](https://support.datacite.org/docs/datacite-graphql-api-guide)</span> which indexes not only DataCite and Crossref, but also <span class="co">[</span><span class="ot">ORCID</span><span class="co">](https://orcid.org/)</span>, and <span class="co">[</span><span class="ot">ROR</span><span class="co">](https://ror.org/)</span>! So, stay tuned for a future blog post demonstrating the use of this amazing service.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>